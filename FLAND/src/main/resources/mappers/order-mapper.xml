<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="order">
	<insert id="add">
		insert into ORDER_TBL (no,orderno,company,serial,orderdate,enddate,fabric,workwidth,workweight,price,color,orderlength,colorbt,etc,person)
		values (null,
			#{orderno},
			#{company},
			#{serial},
			#{orderdate},
			#{enddate, jdbcType=VARCHAR},
			#{fabric},
			#{workwidth},
			#{workweight},
			#{price, jdbcType=VARCHAR},
			#{color},
			#{orderlength},
			#{colorbt, jdbcType=VARCHAR},
			#{etc, jdbcType=VARCHAR},
			#{person}
		)
	</insert>
	<select id="read" resultType="int">
		select count(*) from ORDER_TBL where orderno = #{orderno}
	</select>
	<update id="update">
		update ORDER_TBL set 
			company=#{company},
			serial=#{serial},
			orderdate=#{orderdate},
			enddate=#{enddate, jdbcType=VARCHAR},
			fabric=#{fabric},
			workwidth=#{workwidth},
			workweight=#{workweight},
			price=#{price, jdbcType=VARCHAR},
			color=#{color},
			orderlength=#{orderlength},
			colorbt=#{colorbt, jdbcType=VARCHAR},
			etc=#{etc, jdbcType=VARCHAR},
			person=#{person}
		where orderno=#{orderno}
	</update>
	<insert id="dyeadd">
		insert into dye_tbl (dyeno,orderno,loss,perkg,mixed,method,detail,dyeetc,caution,delivery,testcolor,test,knitcompany,dyecompany)
			values(null,
				#{orderno},
				#{loss},
				#{perkg},
				#{mixed, jdbcType=VARCHAR},
				#{method, jdbcType=VARCHAR},
				#{detail, jdbcType=VARCHAR},
				#{dyeetc, jdbcType=VARCHAR},
				#{caution},
				#{delivery, jdbcType=VARCHAR},
				#{testcolor, jdbcType=VARCHAR},
				#{test, jdbcType=VARCHAR},
				#{knitcompany, jdbcType=VARCHAR},
				#{dyecompany, jdbcType=VARCHAR}
				)
	</insert>
	<insert id="knitadd">
		insert into knit_tbl (knitno,orderno,thread,ratio,weight,thread_com,con,roll,kgttl,knitcompany,delivery,inch,gage,niddle,organ,looplength,lot)
			values(null,
				#{orderno},
				#{thread},
				#{ratio},
				#{weight},
				#{thread_com, jdbcType=VARCHAR},
				#{con},
				#{roll},
				#{kgttl},
				#{knitcompany},
				#{delivery},
				#{inch, jdbcType=INTEGER},
				#{gage, jdbcType=INTEGER},
				#{niddle, jdbcType=INTEGER},
				#{organ, jdbcType=VARCHAR},
				#{looplength, jdbcType=VARCHAR},
				#{lot, jdbcType=VARCHAR}
			)
	</insert>
<!-- paging ORACLE -->
	<!-- 목록 조회 (페이징) -->
	<select id="pageList" resultType="com.fland.domain.OrderVO" >
		SELECT * FROM (
			SELECT ROWNUM rnum, A.* FROM (
				SELECT * FROM ORDER_TBL ORDER BY no DESC
				) A WHERE ROWNUM <![CDATA[<]]>= #{page} * #{perPageNum}
			) WHERE rnum <![CDATA[>]]>  (#{page} -1) * #{perPageNum}
	</select>
	<!-- 목록 총 개수 조회 (전체 조회)-->
	<select id="countPaging" resultType="int">
		SELECT COUNT(no) count FROM ORDER_TBL where no <![CDATA[>]]> 0
	</select>
	
<!-- paging MySQL -->
	<select id="listCriteria" resultType="com.fland.domain.OrderVO">
		<![CDATA[
		select * from order_tbl
		where no > 0
		order by no desc
		limit #{pageStart}, #{perPageNum}
		]]>
	</select>
</mapper>